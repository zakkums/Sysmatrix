#!/usr/bin/env bash
set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "${SCRIPT_DIR}/.." && pwd)"

if command -v sysmatrix >/dev/null 2>&1; then
    resolved="$(command -v sysmatrix)"
    # Prefer an already-installed binary when this script is run from source tree.
    if [[ "$resolved" != "$0" ]]; then
        exec "$resolved" "$@"
    fi
fi

# Development fallback: run directly from local source without installation.
PYTHONPATH="${PROJECT_ROOT}/src" exec python3 -m sysmatrix "$@"
